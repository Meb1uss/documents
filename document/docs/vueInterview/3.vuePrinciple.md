# Vue 原理 

## 对响应式的理解 
1 
## 对虚拟 DOM 的理解 
- 什么是虚拟 DOM？
  - 顾名思义，虚拟的 DOM 对象，是一个 JS 对象
- 为什么要用虚拟 DOM？
   - 有效减少操作 DOM 的次数，减少直接操作 DOM 的次数，减少页面的重绘，提高性能
   - 方便跨平台，同一 VNode 节点可以渲染成不同平台上对应的内容
- 虚拟 DOM 如何生成，如何转换为真实 DOM？
   - 为组件编写模板 template => 被编译器编译成 render 函数 => 生成 VNode 节点 => 通过虚拟 DOM 节点生成真实 DOM 节点
- 后续 diff 算法的作用？
  - 当某些响应式数据发生变化，引起组件重新 render，生成新的虚拟 DOM，diff 算法与将新旧虚拟 DOM 进行对比，进行最小量的 DOM 操作，高效更新视图

## diff 算法
- 什么是 diff 算法？
  - 虚拟 DOM 想要转化为真实 DOM 就需要通过 patch 方法转换
- 为什么需要 diff 算法？
- diff 算法何时执行
  - 组件内响应式数据的变更触发实例执行 render 函数，生成新的虚拟 DOM，新旧虚拟 DOM 进行对比，生成 patchs，根据 patchs 执行 DOM 操作，更新视图
- 具体执行方式
  - 递归过程，遵循**深度优先、同层比较**的策略
    - 首先判断两个节点是否为相同节点，即判断两个节点的 key 和 type 是否相同，不同则直接删除旧节点，创建新节点
    - 如果双方都是文本节点且内容相同，则直接更新文本内容
    - 如果双方都是元素节点，则进行深度遍历子节点，进行递归 diff
- Vue3 中 diff 算法的优化

## key 的作用
- 为什么需要 key
  - key 的作用是提高 diff 算法的效率
- key 的必要性
  - key 是虚拟 DOM 的唯一标识，通过 key 可以精确判断两个节点是否是同一个，从而提高 diff 算法的效率。如果不定义 key，Vue 会将每个节点都设置为相同的 key（undefined），导致无法区分，只能进行全量更新，降低 diff 算法的效率
- key 的实际使用方式 
  - 渲染一组列表时，为列表中的元素设置唯一的 key，方便 Vue 区分哪些元素被修改、添加或者删除。且应该避免使用数组索引作为 key，因为数组索引是会变的，会导致隐蔽的 bug
-  如何判断两个节点是否相同
   -  vue 判断两个节点是否相同时，会判断两个节点的 key 和 type 是否相同，因此 key 的设置非常重要，它直接决定了 diff 算法的效率。
   -  如果不设置 key，则 key 的值默认为 undefined，导致无法区分，只能进行全量更新，降低 diff 算法的效率。
  

## 